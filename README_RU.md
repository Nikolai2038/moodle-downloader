# Moodle Downloader

[EN](README.md) | **RU**

## Описание

Этот Bash-script позволяет скачивать видео со страницы Moodle.

## Требования

- Linux или WSL;
- Bash;
- `libxml-xpath-perl` apt-пакет (он будет установлен автоматически, если ещё не установлен).

Скрипт был протестирован в WSL Debian на Windows 10.

## Использование

1. Склонировать репозиторий:

    ```bash
    git pull https://github.com/Nikolai2038/moodle-downloader.git
    cd moodle-downloader
    ```

2. Скопировать файл `env.sh.example` в `env.sh`;
3. Открыть браузер. Авторизоваться на странице Moodle и открыть курс, видео которого нужно скачать;
4. Скопировать ссылку на курс и вставить её в файл `env.sh` - изменить значение переменной `LINK`;
5. В браузере открыть DevTools через горячую клавишу `F12`;
6. Перезагрузить страницу;
7. На вкладке `Network` отфильтровать запросы по типу - установить `HTML`. Должен остаться один запрос;
8. Нажать ПКМ по запросу и выбрать вкладку `Headers` для него;
9. Скопировать значение заголовка `Cookie` и вставить его в файл `env.sh` - изменить значение переменной `COOKIE`;
10. Выполнить сам скрипт:

    ```bash
    ./moodle_downloader.sh
    ```

   После запуска команды, скрипт начнёт скачивать все видео в папку `./downloads/courses/<название курса>/<номер секции> - <название секции>` (эти директории будут созданы автоматически).
   Видео будут названы `<номер видео> - <название видео>.mp4`.

Дополнительно, скрипт кэширует все HTML-страницы внутри директории `./downloads/cache`, чтобы снизить количество обращений к сайту при повторных вызовах скрипта.

Скрипт также не скачивает видео, если файл с таким названием уже существует.
Поэтому, если необходимо заново скачать видео - достаточно просто удалить нужные.
Аналогично для HTML-файлов.

## Развитие

Не стесняйтесь участвовать в развитии репозитория, используя [pull requests](https://github.com/Nikolai2038/moodle-downloader/pulls) или [issues](https://github.com/Nikolai2038/moodle-downloader/issues)!
